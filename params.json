{"name":"Laravel-paypal","tagline":"Laravel plugin For Processing Payments Through Paypal","body":"# Laravel PayPal\r\n\r\n- [Introduction](#introduction)\r\n- [Installation](#installation)\r\n- [Usage](#usage)\r\n- [Handling PayPal IPN](#paypalipn)\r\n- [Support](#support)\r\n\r\n<a name=\"introduction\"></a>\r\n## Introduction\r\n\r\nLaravel plugin For Processing Payments Through Paypal. Using this plugin you can process or refund payments and handle IPN (Instant Payment Notification) from PayPal in your Laravel application.\r\n\r\n**Currently only PayPal Express Checkout Is Supported.**\r\n\r\n\r\n<a name=\"installation\"></a>\r\n## Installation\r\n\r\n* Use following command to install:\r\n\r\n```\r\ncomposer require srmklive/paypal\r\n```\r\n\r\n* Add the service provider to your $providers array in config/app.php file like: \r\n\r\n```\r\n'Srmklive\\PayPal\\Providers\\PayPalServiceProvider' // Laravel 5\r\n```\r\n```\r\nSrmklive\\PayPal\\Providers\\PayPalServiceProvider::class // Laravel 5.1 or greater\r\n```\r\n\r\n* Add the alias to your $aliases array in config/app.php file like: \r\n\r\n```\r\n'PayPal' => 'Srmklive\\PayPal\\Providers\\Facades\\PayPal' // Laravel 5\r\n```\r\n```\r\n'PayPal' => Srmklive\\PayPal\\Providers\\Facades\\PayPal::class // Laravel 5.1 or greater\r\n```\r\n\r\n* Run the following command to publish configuration:\r\n\r\n```\r\nphp artisan vendor:publish\r\n```\r\n\r\n## Usage\r\n\r\n```\r\n$data = [];\r\n$data['items'] = [\r\n    [\r\n        'name' => 'Product 1',\r\n        'price' => 9.99\r\n    ],\r\n    [\r\n        'name' => 'Product 2',\r\n        'price' => 4.99\r\n    ]\r\n];\r\n\r\n$data['invoice_id'] = 1;\r\n$data['invoice_description'] = \"Order #$data[invoice_id] Invoice\";\r\n$data['return_url'] = url('/payment/success');\r\n$data['cancel_url'] = url('/cart');\r\n\r\n$total = 0;\r\nforeach($data['items'] as $item) {\r\n    $total += $item['price'];\r\n}\r\n\r\n$data['total'] = $total;\r\n```\r\n\r\n\r\n* SetExpressCheckout\r\n\r\n    ```\r\n    $response = PayPal::getProvider()->setExpressCheckout($data);\r\n    return redirect($response['paypal_link']); // This will redirect user to PayPal\r\n    ```\r\n\r\n* GetExpressCheckoutDetails\r\n\r\n    ```\r\n    $response = PayPal::getProvider()->getExpressCheckoutDetails($token);\r\n    ```\r\n\r\n* DoExpressCheckoutPayment \r\n\r\n    ```\r\n    // Note that 'token', 'PayerID' are values returned by PayPal when it redirects to success page after successful verification of user's PayPal info.\r\n    $response = PayPal::getProvider()->doExpressCheckoutPayment($data, $token, $PayerID);\r\n    ```\r\n\r\n* RefundTransaction\r\n\r\n    ```\r\n    $response = PayPal::getProvider()->refundTransaction($transactionid);\r\n    ```\r\n\r\n<a name=\"paypalipn\"></a>\r\n## Handling PayPal IPN\r\nYou can also handle Instant Payment Notifications from PayPal.\r\nSuppose you have set IPN URL to **http://example.com/ipn/notify/** in PayPal. To handle IPN you should do the following:\r\n\r\n* First add the **ipn/notify** tp your routes file:\r\n\r\n    ```\r\n    Route::post('ipn/notify','PayPalController@postNotify'); // Change it accordingly in your application\r\n    ```\r\n          \r\n* Open **App\\Http\\Middleware\\VerifyCsrfToken.php** and add your IPN route to **$excluded** routes variable.\r\n\r\n    ```\r\n    'ipn/notify'\r\n    ```\r\n\r\n* Then in the controller where you are handling IPN, do the following:\r\n\r\n    ```\r\n    // Put this above controller definition\r\n    use Srmklive\\PayPal\\Traits\\IPNResponse As PayPalIPN;\r\n    \r\n    // Then add the following before function declaration\r\n    use PayPalIPN;\r\n    ```\r\n    \r\n* The above step saves the PayPal IPN response as **ipn** in session. Following is the code you can change to your own requirements for handling IPN:    \r\n    \r\n    ```\r\n    /**\r\n     * Retrieve IPN Response From PayPal\r\n     *\r\n     * @param \\Illuminate\\Http\\Request $request\r\n     */\r\n    public function postNotify(Request $request)\r\n    {\r\n        $post = [];\r\n        $request_params = $request->all();\r\n\r\n        foreach ($request_params as $key=>$value)\r\n            $post[$key] = $value;\r\n\r\n        $post['cmd'] = '_notify-validate';\r\n\r\n        $response = $this->verifyIPN($post);\r\n\r\n        session([\r\n            'ipn' => $response\r\n        ]);\r\n    }        \r\n    ```\r\n            \r\n<a name=\"support\"></a>\r\n## Support\r\n\r\nThis plugin only supports Laravel 5 or greater.\r\n* In case of any issues, kindly create one on the [Issues](https://github.com/srmklive/laravel-paypal/issues) section.\r\n* If you would like to contribute:\r\n  * Fork this repository.\r\n  * Implement your features.\r\n  * Generate pull request.\r\n \r\n","google":"UA-35820672-1","note":"Don't delete this file! It's used internally to help with page regeneration."}